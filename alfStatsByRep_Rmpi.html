<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>ALFRESCO Statistics: Rmpi Code</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.1/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/respond.min.js"></script>
<style type="text/css">

/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
}
@media (max-width: 979px) {
  body {
    padding-top: 0;
  }
}

/* offset scroll position for anchor links (for fixed navbar)  */
@media (min-width: 980px) {
  .section h2 {
    padding-top: 52px;
    margin-top: -52px;
  }
  .section h3 {
    padding-top: 52px;
    margin-top: -52px;
  }
}


/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}

</style>

<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46129458-3', 'auto');
  ga('send', 'pageview');

</script>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">

<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="brand" href="index.html">SNAP Data QAQC</a>
      <div class="nav-collapse collapse">
        <ul class="nav">
          <li><a href="index.html">Overview</a></li>

          <li><a href="code_sankey.html">Code flow</a></li>

          <li class="dropdown">
            <a href="gcm-climate-outputs" class="dropdown-toggle" data-toggle="dropdown">GCM climate outputs <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="nav-header">Extraction</li>
              <li><a href="AR4_AR5_extract.html">Downscaled GCMs</a></li>
              <li class="divider"></li>
              <li class="nav-header">Organization</li>
              <li><a href="stats_setup.html">Regions: stats</a></li>
              <li><a href="samples_setup.html">Regions: densities</a></li>
              <li><a href="cities_setup.html">Cities: stats</a></li>
            </ul>

          <li class="dropdown">
            <a href="cru-3.1-climate-data" class="dropdown-toggle" data-toggle="dropdown">CRU 3.1 climate data <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="nav-header">Extraction</li>
              <li><a href="CRU_extract.html">Downscaled CRU 3.1</a></li>
              <li class="divider"></li>
              <li class="nav-header">Organization</li>
              <li><a href="stats_setup_CRU31.html">Regions: stats</a></li>
              <li><a href="samples_setup_CRU31.html">Regions: densities</a></li>
              <li><a href="cities_setup_CRU31.html">Cities: stats</a></li>
            </ul>

          <li class="dropdown">
            <a href="fire-and-vegetation" class="dropdown-toggle" data-toggle="dropdown">Fire and Vegetation <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="nav-header">Extraction</li>
              <li><a href="alfStatsByRep_Rmpi.html">ALFRESCO: Rmpi</a></li>
              <li><a href="alfStatsByRep.html">ALFRESCO: functions</a></li>
              <li class="divider"></li>
              <li class="nav-header">Organization</li>
              <li><a href="getAlfStatsAndDensities.html">ALFRESCO: stats and densities</a></li>
            </ul>

          <li class="dropdown">
            <a href="additional-r-code" class="dropdown-toggle" data-toggle="dropdown">Additional R Code <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="qaqc_app_metadata.html">QAQC App Metadata</a></li>
            </ul>

          <li><a href="http://leonawicz.github.io">All Projects</a></li>
        </ul>
        <ul class="nav pull-right">
          <a class="btn btn-primary" href="https://github.com/leonawicz/SNAPQAQC">
            <i class="fa fa-github fa-lg"></i>
            Github
          </a>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div>

<div id="header">
<h1 class="title">ALFRESCO Statistics: Rmpi Code</h1>
</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <code>alfStatsByRep_Rmpi.R</code> script uses <code>Rmpi</code> to efficiently extract fire and vegetation statistics from calibrated, finalized ALFRESCO run output over the full Alaska-Canada 1-km resolution ALFRESCO extent. Data are saved to <strong>R</strong> workspaces (.RData files) for analysis and graphing by subsequent <strong>R</strong> code.</p>
<div id="motivation" class="section level3">
<h3>Motivation</h3>
<p>The primary motivation for this code is not just to extract regional data from a large number of high-resolution geotiffs, but to limit the routine recurrence and redundancy of such extractions. It allows for storing commonly required data in a more compact format that can be quickly shared and digested by other projects.</p>
</div>
<div id="details" class="section level3">
<h3>Details</h3>
<div id="capabilities" class="section level4">
<h4>Capabilities</h4>
<p>Extractions occur across multiple climate model and scenario-driven runs for multiple simulation replicates. Statistics are extracted from geotiff output map layers for the entire spatial extent as well as an arbitrary number of spatial subregions.</p>
</div>
<div id="limitations" class="section level4">
<h4>Limitations</h4>
<p>This script is intended to run on a single climate model-driven set of ALFRESCO output files at a time; one model-scenario pair. This is because the outputs for each model-scenario pair consist of 200 simulation replicates. This is plenty to process at one time. Scripts further downstream are written with some expectation of this upstream process compiling output statistics based on all replicates, regardless of how many models or scenarios are processed at once.</p>
</div>
</div>
<div id="files-and-data" class="section level3">
<h3>Files and Data</h3>
<p>The input files include 1-km Alaska-Canada extent data from ALFRESCO simulations as well as raster layer cell indices pertaining to various regional shapefile polygons. <code>alfStatsByRep_Rpmi.R</code> is called via slurm script, <code>alfStatsByRep_Rmpi.slurm</code> and is itself a wrapper around <code>alfStatsByRep.R</code> which performs data extractions on multiple CPU cores across multiple compute nodes.</p>
<p>The <code>alfStatsByRep_Rpmi.R</code> gathers on a head node the data extracted from ALFRESCO outputs on the CPU cores across all the processing nodes and writes these data to intermediary .RData workspace files: * Burn area by region * Fire frequency by region * Vegetated area by region and vegetation class</p>
<p>Other data are written to files directly by the compute nodes, avoiding returning too much data to the head node. This consists of distributional information, in contrast to specific computed statistics.</p>
<p>Intermediate outputs are handled by additional <strong>R</strong> scripts.</p>
</div>
</div>
<div id="r-code" class="section level2">
<h2>R code</h2>
<div id="setup" class="section level3">
<h3>Setup</h3>
<p>ADD_TEXT_HERE: EXAMPLE Setup consists of loading required <strong>R</strong> packages and additional files, preparing any command line arguments for use, and defining functions and other <strong>R</strong> objects.</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
